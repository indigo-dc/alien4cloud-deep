tosca_definitions_version: "tosca_simple_yaml_1_0"\ndescription: "{\"deploymentPaasId\":\"a4c-paas-id\",\"deploymentId\":\"a4c-id\",\"locationIds\":[],\"orchestratorId\":\"a4c-orchestrator-id\",\"versionId\":\"a4c-version-id\"}"\ntopology_template:\n  inputs:\n    admin_username:\n      type: "string"\n      required: true\n      default: "admin"\n    fe_cpus:\n      type: "integer"\n      required: false\n      constraints:\n      - greater_or_equal: 1\n      description: "Number of (actual or virtual) CPUs associated with the Compute\\n        \ node."\n    wn_num:\n      type: "integer"\n      required: false\n      default: 1\n      description: "the number of resources"\n    wn_mem:\n      type: "scalar-unit.size"\n      required: false\n      constraints:\n      - greater_or_equal: "0 MB"\n      description: "Size of memory available to applications running on the Compute\\n        \ node (default unit is MB)."\n    wn_cpus:\n      type: "integer"\n      required: false\n      constraints:\n      - greater_or_equal: 1\n      description: "Number of (actual or virtual) CPUs associated with the Compute\\n        \ node."\n    admin_token:\n      type: "string"\n      required: true\n      default: "token"\n    fe_mem:\n      type: "scalar-unit.size"\n      required: false\n      constraints:\n      - greater_or_equal: "0 MB"\n      description: "Size of memory available to applications running on the Compute\\n        \ node (default unit is MB)."\n  node_templates:\n    wn_node:\n      type: "tosca.nodes.indigo.LRMS.WorkerNode.Kubernetes"\n      properties:\n        front_end_ip: "127.0.0.1"\n        hybrid: false\n      requirements:\n      - host:\n          node: "lrms_wn"\n          capability: "tosca.capabilities.indigo.Container"\n          relationship: "tosca.relationships.HostedOn"\n      capabilities:\n        wn:\n          properties:\n            min_instances: 1\n            max_instances: 1\n            default_instances: 1\n    lrms_wn:\n      type: "tosca.nodes.indigo.Compute"\n      properties:\n        zabbix_server: "orchestrator.cloud.cnaf.infn.it"\n        zabbix_server_port: 10051\n        zabbix_server_metadata: "Linux      668c875e-9a39-4dc0-a710-17c41376c1e0"\n      capabilities:\n        scalable:\n          properties:\n            min_instances: 1\n            max_instances: 1\n            count:\n              get_input: "wn_num"\n            default_instances: 1\n        endpoint:\n          properties:\n            private_ip: true\n            protocol: "tcp"\n            secure: false\n            network_name: "PRIVATE"\n            initiator: "source"\n        host:\n          properties:\n            num_cpus:\n              get_input: "wn_cpus"\n            mem_size:\n              get_input: "wn_mem"\n    lrms_server:\n      type: "tosca.nodes.indigo.Compute"\n      properties:\n        zabbix_server: "orchestrator.cloud.cnaf.infn.it"\n        zabbix_server_port: 10051\n        zabbix_server_metadata: "Linux      668c875e-9a39-4dc0-a710-17c41376c1e0"\n      capabilities:\n        scalable:\n          properties:\n            min_instances: 1\n            max_instances: 1\n            count: 1\n            default_instances: 1\n        os:\n          properties:\n            image: "linux-ubuntu-16.04-vmi"\n        endpoint:\n          properties:\n            dns_name: "kubeserver"\n            private_ip: true\n            protocol: "tcp"\n            port: 6443\n            secure: true\n            network_name: "PUBLIC"\n            initiator: "source"\n        host:\n          properties:\n            num_cpus:\n              get_input: "fe_cpus"\n            mem_size:\n              get_input: "fe_mem"\n    lrms_front_end:\n      type: "tosca.nodes.indigo.LRMS.FrontEnd.Kubernetes"\n      properties:\n        admin_username:\n          get_input: "admin_username"\n        admin_token:\n          get_input: "admin_token"\n        wn_ips: null\n        hybrid: false\n      requirements:\n      - host:\n          node: "lrms_server"\n          capability: "tosca.capabilities.indigo.Container"\n          relationship: "tosca.relationships.HostedOn"\n      capabilities:\n        lrms:\n          properties:\n            type: "kubernetes"\n    jupyterhub:\n      type: "tosca.nodes.indigo.JupyterHub"\n      properties:\n        spawner: "kubernetes"\n      requirements:\n      - dependency:\n          node: "lrms_front_end"\n          capability: "tosca.capabilities.Node"\n          relationship: "tosca.relationships.DependsOn"\n      - host:\n          node: "lrms_server"\n          capability: "tosca.capabilities.indigo.Container"\n          relationship: "tosca.relationships.HostedOn"\n  outputs:\n    lrms_server_public_address:\n      value:\n        get_attribute:\n        - "lrms_server"\n        - "public_address"\n    lrms_server_public_ip_address:\n      value:\n        get_attribute:\n        - "lrms_server"\n        - "public_ip_address"\nimports:\n- "indigo_custom_types: https://raw.githubusercontent.com/indigo-dc/tosca-types/master/custom_types.yaml"\n